<p-card styleClass="w-full">
  <ng-template pTemplate="header">
    <div class="flex flex-column sm:flex-row align-items-start sm:align-items-center justify-content-between px-3 sm:px-4 py-3 sm:py-4 border-bottom-1 surface-border gap-3 sm:gap-0">
      <h2 class="text-xl font-semibold m-0 text-900">Task List</h2>
      <p-button 
        label="Create Task" 
        icon="pi pi-plus" 
        (onClick)="createNewTask()"
        size="small"
        styleClass="p-button-outlined w-full sm:w-auto">
      </p-button>
    </div>
  </ng-template>

  <ng-template pTemplate="content">
    <div class="px-3 sm:px-4 py-3 sm:py-4">
      <!-- ToDo Section -->
      <div class="mb-6">
        <h3 class="text-lg font-medium mb-4 text-600">ToDo</h3>
        <div class="flex flex-column">
          <div 
            *ngFor="let task of todoTasks; let last = last" 
            class="flex flex-column sm:flex-row sm:align-items-center justify-content-between py-3 cursor-pointer gap-3 sm:gap-0"
            [class.border-bottom-1]="!last"
            [class.surface-border]="!last">
            
            <div class="flex align-items-start sm:align-items-center gap-3 flex-1">
              <p-checkbox 
                [binary]="true"
                [ngModel]="task.completed"
                (ngModelChange)="toggleTaskCompletion(task)"
                styleClass="mt-1 sm:mt-0">
              </p-checkbox>
              
              <div class="flex flex-column flex-1">
                <span class="text-900 font-medium mb-1">{{ task.title }}</span>
                <span class="text-600 text-sm">{{ task.description }}</span>
              </div>
            </div>

            <div class="flex flex-row sm:flex-row align-items-center justify-content-between gap-2 sm:gap-3 w-full sm:w-auto">
              <!-- Priority Badge - largura quase total no mobile -->
              <p-tag 
                [value]="getPriorityLabel(task.priority)"
                [severity]="getPrioritySeverity(task.priority)"
                styleClass="text-xs flex-1 sm:flex-none">
              </p-tag>

              <!-- Menu Button - fixo no canto direito -->
              <p-button 
                icon="pi pi-ellipsis-v" 
                [text]="true"
                size="small"
                (onClick)="openEditSidebar(task)"
                styleClass="p-button-rounded p-button-text flex-shrink-0">
              </p-button>
            </div>
          </div>
        </div>
      </div>

      <!-- Completed Section -->
      <div>
        <h3 class="text-lg font-medium mb-4 text-600">Completed</h3>
        <div class="flex flex-column">
          <div 
            *ngFor="let task of completedTasks; let last = last" 
            class="flex flex-column sm:flex-row sm:align-items-center justify-content-between py-3 cursor-pointer gap-3 sm:gap-0"
            [class.border-bottom-1]="!last"
            [class.surface-border]="!last"
            style="opacity: 0.7;">
            
            <div class="flex align-items-start sm:align-items-center gap-3 flex-1">
              <p-checkbox 
                [binary]="true"
                [ngModel]="task.completed"
                (ngModelChange)="toggleTaskCompletion(task)"
                styleClass="mt-1 sm:mt-0">
              </p-checkbox>
              
              <div class="flex flex-column flex-1">
                <span class="text-900 font-medium mb-1 line-through">{{ task.title }}</span>
                <span class="text-600 text-sm line-through">{{ task.description }}</span>
              </div>
            </div>

            <div class="flex flex-row sm:flex-row align-items-center justify-content-between gap-2 sm:gap-3 w-full sm:w-auto">
              <!-- Priority Badge - largura quase total no mobile -->
              <p-tag 
                [value]="getPriorityLabel(task.priority)"
                [severity]="getPrioritySeverity(task.priority)"
                styleClass="text-xs flex-1 sm:flex-none">
              </p-tag>

              <!-- Menu Button - fixo no canto direito -->
              <p-button 
                icon="pi pi-ellipsis-v" 
                [text]="true"
                size="small"
                (onClick)="openEditSidebar(task)"
                styleClass="p-button-rounded p-button-text flex-shrink-0">
              </p-button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</p-card>

<!-- Task Edit Sidebar -->
<app-task-edit-sidebar
  [visible]="sidebarVisible"
  [task]="selectedTask"
  (visibleChange)="onSidebarVisibleChange($event)"
  (taskSaved)="onTaskSaved($event)"
  (taskDeleted)="onTaskDeleted($event)">
</app-task-edit-sidebar>