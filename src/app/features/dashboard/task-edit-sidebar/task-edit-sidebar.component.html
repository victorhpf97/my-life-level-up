<p-drawer 
  [(visible)]="visible" 
  position="right"
  [modal]="true"
  styleClass="w-full md:w-30rem"
  (onHide)="onSidebarHide()">
  
  <ng-template pTemplate="header">
    <div class="flex align-items-center gap-2">
      <i class="pi pi-pencil text-primary"></i>
      <span class="font-semibold text-lg">Edit Task</span>
    </div>
  </ng-template>

  <div class="flex flex-column gap-4 p-4">
    <!-- Task Title -->
    <div class="flex flex-column gap-2">
      <label class="font-medium text-900">Title</label>
      <input 
        type="text" 
        pInputText 
        [(ngModel)]="editTitle"
        placeholder="Enter task title"
        class="w-full">
    </div>

    <!-- Task Description -->
    <div class="flex flex-column gap-2">
      <label class="font-medium text-900">Description</label>
      <textarea 
        [(ngModel)]="editDescription"
        placeholder="Enter task description"
        rows="3"
        class="w-full border-1 surface-border border-round p-2">
      </textarea>
    </div>

    <!-- Task Date -->
    <div class="flex flex-column gap-2">
      <label class="font-medium text-900">Task Date</label>
      <p-datePicker [(ngModel)]="editTaskDate" dateFormat="dd/mm/yy" [showIcon]="true" styleClass="w-full"></p-datePicker>
    </div>

    <!-- Completed Checkbox -->
    <div class="flex align-items-center gap-2">
      <p-checkbox [binary]="true" [(ngModel)]="editCompleted"></p-checkbox>
      <label class="m-0">Completed</label>
    </div>

    <!-- Priority -->
    <div class="flex flex-column gap-2">
      <label class="font-medium text-900">Priority</label>
      <p-select 
        [(ngModel)]="editPriority"
        [options]="priorityOptions"
        optionLabel="label"
        optionValue="value"
        placeholder="Select Priority"
        styleClass="w-full">
        <ng-template pTemplate="selectedItem">
          <div class="flex align-items-center gap-2" *ngIf="editPriority">
            <span class="text-sm">{{ getPriorityLabelFromValue(editPriority) }}</span>
          </div>
        </ng-template>
        <ng-template pTemplate="item" let-option>
          <div class="flex align-items-center gap-2">
            <span class="text-sm">{{ option.label }}</span>
          </div>
        </ng-template>
      </p-select>
    </div>

    <!-- Task Type -->
    <div class="flex flex-column gap-2">
      <label class="font-medium text-900">Task Type</label>
      <div class="flex flex-column gap-3">
        <div class="flex align-items-center gap-2" *ngFor="let option of taskTypeOptions">
          <p-radioButton 
            [inputId]="option.value"
            [(ngModel)]="editType"
            [value]="option.value">
          </p-radioButton>
          <label [for]="option.value" class="flex align-items-center gap-2 cursor-pointer">
            <i [class]="'pi ' + option.icon"></i>
            <span>{{ option.label }}</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Duration (only for timer tasks) -->
    <div class="flex flex-column gap-2" *ngIf="editType === 'timer'">
      <label class="font-medium text-900">Duration (minutes)</label>
      <p-inputNumber 
        [(ngModel)]="editDuration"
        [min]="1"
        [max]="480"
        suffix=" min"
        placeholder="Enter duration"
        styleClass="w-full">
      </p-inputNumber>
      <small class="text-600">Duration between 1 and 480 minutes (8 hours)</small>
    </div>

    <!-- Action Buttons -->
    <div class="flex flex-column gap-2 mt-4">
      <p-button 
        label="Save Changes" 
        icon="pi pi-check"
        (onClick)="onSave()"
        [disabled]="!editTitle.trim()"
        styleClass="w-full">
      </p-button>
      
      <p-button 
        label="Cancel" 
        icon="pi pi-times"
        (onClick)="onCancel()"
        severity="secondary"
        styleClass="w-full">
      </p-button>
      
      <p-button 
        label="Delete Task" 
        icon="pi pi-trash"
        (onClick)="onDelete()"
        severity="danger"
        [outlined]="true"
        styleClass="w-full mt-2">
      </p-button>
    </div>
  </div>
</p-drawer>